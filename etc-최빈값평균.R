??????????????? <- read_csv(file = "C:/?????????/???????????????_????????????.csv", col_names = TRUE, locale=locale('ko',encoding='euc-kr'))

??????????????? %>% view()

# ?????????
get_modemax <- function(x) {
  uniqv <- unique(x)
  uniqv[which.max(tabulate(match(x, uniqv)))]
}

get_modemin <- function(x) {
  uniqv <- unique(x)
  uniqv[which.min(tabulate(match(x, uniqv)))]
}

???????????????$?????? <- str_sub(???????????????$??????,6,7)

# 4???
???????????????_4???_mode <- {??????????????? %>%
    filter(!is.na(??????)) %>% 
    filter(?????? == "04") %>%
    group_by(??????????????????) %>% 
    summarise(
      ??????????????????_mode = get_modemax(??????????????????),
      ??????_1??????_mode = get_modemax(??????_1?????? %>% na.omit),
      ??????_2??????_mode = get_modemax(??????_2?????? %>% na.omit),
      ??????_3??????_mode = get_modemax(??????_3?????? %>% na.omit),
      ??????_4??????_mode = get_modemax(??????_4?????? %>% na.omit),
      ??????_???_mode = get_modemax(??????_??? %>% na.omit),
      ??????_???_mode = get_modemax(??????_??? %>% na.omit),
      ??????_mode = get_modemax(?????? %>% na.omit),      
      PR_mode = get_modemax(PR %>% na.omit), 
      BT_mode = get_modemax(BT %>% na.omit), 
      RR_mode = get_modemax(RR %>% na.omit), 
      ????????????_cc1_mode = get_modemax(????????????_cc1 %>% na.omit), 
      ????????????_cc2_mode = get_modemax(????????????_cc2 %>% na.omit), 
      ????????????_cc3_mode = get_modemax(????????????_cc3 %>% na.omit), 
      ????????????_cc4_mode = get_modemax(????????????_cc4 %>% na.omit), 
      L_tube_?????????_mode = get_modemax(L_tube_????????? %>% na.omit), 
      L_tube_????????????_mode = get_modemax(L_tube_???????????? %>% na.omit), 
      Gastrostomy_tube_?????????_mode = get_modemax(Gastrostomy_tube_????????? %>% na.omit), 
      Gastrostomy_tube_????????????_mode = get_modemax(Gastrostomy_tube_???????????? %>% na.omit),
      ??????_oral_nasal_mode = get_modemax(??????_oral_nasal %>% na.omit),
      ??????_intra_tracheal_mode = get_modemax(??????_intra_tracheal %>% na.omit),
      ???????????????_?????????_mode = get_modemax(???????????????_????????? %>% na.omit),
      ????????????_????????????_mode = get_modemax(????????????_???????????? %>% na.omit),
      ????????????_??????????????????_mode = get_modemax(????????????_?????????????????? %>% na.omit))
}

write.csv(???????????????_4???_mode, file = "C:/?????????/???????????????_4???_mode.csv", row.names=FALSE)


# 5???
???????????????_5???_mode <- {??????????????? %>%
    filter(!is.na(??????)) %>% 
    filter(?????? == "05") %>%
    group_by(??????????????????) %>% 
    summarise(
      ??????????????????_mode = get_modemax(??????????????????),
      ??????_1??????_mode = get_modemax(??????_1?????? %>% na.omit),
      ??????_2??????_mode = get_modemax(??????_2?????? %>% na.omit),
      ??????_3??????_mode = get_modemax(??????_3?????? %>% na.omit),
      ??????_4??????_mode = get_modemax(??????_4?????? %>% na.omit),
      ??????_???_mode = get_modemax(??????_??? %>% na.omit),
      ??????_???_mode = get_modemax(??????_??? %>% na.omit),
      ??????_mode = get_modemax(?????? %>% na.omit),      
      PR_mode = get_modemax(PR %>% na.omit), 
      BT_mode = get_modemax(BT %>% na.omit), 
      RR_mode = get_modemax(RR %>% na.omit), 
      ????????????_cc1_mode = get_modemax(????????????_cc1 %>% na.omit), 
      ????????????_cc2_mode = get_modemax(????????????_cc2 %>% na.omit), 
      ????????????_cc3_mode = get_modemax(????????????_cc3 %>% na.omit), 
      ????????????_cc4_mode = get_modemax(????????????_cc4 %>% na.omit), 
      L_tube_?????????_mode = get_modemax(L_tube_????????? %>% na.omit), 
      L_tube_????????????_mode = get_modemax(L_tube_???????????? %>% na.omit), 
      Gastrostomy_tube_?????????_mode = get_modemax(Gastrostomy_tube_????????? %>% na.omit), 
      Gastrostomy_tube_????????????_mode = get_modemax(Gastrostomy_tube_???????????? %>% na.omit),
      ??????_oral_nasal_mode = get_modemax(??????_oral_nasal %>% na.omit),
      ??????_intra_tracheal_mode = get_modemax(??????_intra_tracheal %>% na.omit),
      ???????????????_?????????_mode = get_modemax(???????????????_????????? %>% na.omit),
      ????????????_????????????_mode = get_modemax(????????????_???????????? %>% na.omit),
      ????????????_??????????????????_mode = get_modemax(????????????_?????????????????? %>% na.omit))
  }

write.csv(???????????????_5???_mode, file = "C:/?????????/???????????????_5???_mode.csv", row.names=FALSE)

# 6???
???????????????_6???_mode <- {??????????????? %>%
    filter(!is.na(??????)) %>% 
    filter(?????? == "06") %>%
    group_by(??????????????????) %>% 
    summarise(
      ??????????????????_mode = get_modemax(??????????????????),
      ??????_1??????_mode = get_modemax(??????_1?????? %>% na.omit),
      ??????_2??????_mode = get_modemax(??????_2?????? %>% na.omit),
      ??????_3??????_mode = get_modemax(??????_3?????? %>% na.omit),
      ??????_4??????_mode = get_modemax(??????_4?????? %>% na.omit),
      ??????_???_mode = get_modemax(??????_??? %>% na.omit),
      ??????_???_mode = get_modemax(??????_??? %>% na.omit),
      ??????_mode = get_modemax(?????? %>% na.omit),      
      PR_mode = get_modemax(PR %>% na.omit), 
      BT_mode = get_modemax(BT %>% na.omit), 
      RR_mode = get_modemax(RR %>% na.omit), 
      ????????????_cc1_mode = get_modemax(????????????_cc1 %>% na.omit), 
      ????????????_cc2_mode = get_modemax(????????????_cc2 %>% na.omit), 
      ????????????_cc3_mode = get_modemax(????????????_cc3 %>% na.omit), 
      ????????????_cc4_mode = get_modemax(????????????_cc4 %>% na.omit), 
      L_tube_?????????_mode = get_modemax(L_tube_????????? %>% na.omit), 
      L_tube_????????????_mode = get_modemax(L_tube_???????????? %>% na.omit), 
      Gastrostomy_tube_?????????_mode = get_modemax(Gastrostomy_tube_????????? %>% na.omit), 
      Gastrostomy_tube_????????????_mode = get_modemax(Gastrostomy_tube_???????????? %>% na.omit),
      ??????_oral_nasal_mode = get_modemax(??????_oral_nasal %>% na.omit),
      ??????_intra_tracheal_mode = get_modemax(??????_intra_tracheal %>% na.omit),
      ???????????????_?????????_mode = get_modemax(???????????????_????????? %>% na.omit),
      ????????????_????????????_mode = get_modemax(????????????_???????????? %>% na.omit),
      ????????????_??????????????????_mode = get_modemax(????????????_?????????????????? %>% na.omit))
}

write.csv(???????????????_6???_mode, file = "C:/?????????/???????????????_6???_mode.csv", row.names=FALSE)

# 7???
???????????????_7???_mode <- {??????????????? %>%
    filter(!is.na(??????)) %>% 
    filter(?????? == "05") %>%
    group_by(??????????????????) %>% 
    summarise(
      ??????????????????_mode = get_modemax(??????????????????),
      ??????_1??????_mode = get_modemax(??????_1?????? %>% na.omit),
      ??????_2??????_mode = get_modemax(??????_2?????? %>% na.omit),
      ??????_3??????_mode = get_modemax(??????_3?????? %>% na.omit),
      ??????_4??????_mode = get_modemax(??????_4?????? %>% na.omit),
      ??????_???_mode = get_modemax(??????_??? %>% na.omit),
      ??????_???_mode = get_modemax(??????_??? %>% na.omit),
      ??????_mode = get_modemax(?????? %>% na.omit),      
      PR_mode = get_modemax(PR %>% na.omit), 
      BT_mode = get_modemax(BT %>% na.omit), 
      RR_mode = get_modemax(RR %>% na.omit), 
      ????????????_cc1_mode = get_modemax(????????????_cc1 %>% na.omit), 
      ????????????_cc2_mode = get_modemax(????????????_cc2 %>% na.omit), 
      ????????????_cc3_mode = get_modemax(????????????_cc3 %>% na.omit), 
      ????????????_cc4_mode = get_modemax(????????????_cc4 %>% na.omit), 
      L_tube_?????????_mode = get_modemax(L_tube_????????? %>% na.omit), 
      L_tube_????????????_mode = get_modemax(L_tube_???????????? %>% na.omit), 
      Gastrostomy_tube_?????????_mode = get_modemax(Gastrostomy_tube_????????? %>% na.omit), 
      Gastrostomy_tube_????????????_mode = get_modemax(Gastrostomy_tube_???????????? %>% na.omit),
      ??????_oral_nasal_mode = get_modemax(??????_oral_nasal %>% na.omit),
      ??????_intra_tracheal_mode = get_modemax(??????_intra_tracheal %>% na.omit),
      ???????????????_?????????_mode = get_modemax(???????????????_????????? %>% na.omit),
      ????????????_????????????_mode = get_modemax(????????????_???????????? %>% na.omit),
      ????????????_??????????????????_mode = get_modemax(????????????_?????????????????? %>% na.omit))
}

write.csv(???????????????_7???_mode, file = "C:/?????????/???????????????_7???_mode.csv", row.names=FALSE)

# 8???
???????????????_8???_mode <- {??????????????? %>%
    filter(!is.na(??????)) %>% 
    filter(?????? == "05") %>%
    group_by(??????????????????) %>% 
    summarise(
      ??????????????????_mode = get_modemax(??????????????????),
      ??????_1??????_mode = get_modemax(??????_1?????? %>% na.omit),
      ??????_2??????_mode = get_modemax(??????_2?????? %>% na.omit),
      ??????_3??????_mode = get_modemax(??????_3?????? %>% na.omit),
      ??????_4??????_mode = get_modemax(??????_4?????? %>% na.omit),
      ??????_???_mode = get_modemax(??????_??? %>% na.omit),
      ??????_???_mode = get_modemax(??????_??? %>% na.omit),
      ??????_mode = get_modemax(?????? %>% na.omit),      
      PR_mode = get_modemax(PR %>% na.omit), 
      BT_mode = get_modemax(BT %>% na.omit), 
      RR_mode = get_modemax(RR %>% na.omit), 
      ????????????_cc1_mode = get_modemax(????????????_cc1 %>% na.omit), 
      ????????????_cc2_mode = get_modemax(????????????_cc2 %>% na.omit), 
      ????????????_cc3_mode = get_modemax(????????????_cc3 %>% na.omit), 
      ????????????_cc4_mode = get_modemax(????????????_cc4 %>% na.omit), 
      L_tube_?????????_mode = get_modemax(L_tube_????????? %>% na.omit), 
      L_tube_????????????_mode = get_modemax(L_tube_???????????? %>% na.omit), 
      Gastrostomy_tube_?????????_mode = get_modemax(Gastrostomy_tube_????????? %>% na.omit), 
      Gastrostomy_tube_????????????_mode = get_modemax(Gastrostomy_tube_???????????? %>% na.omit),
      ??????_oral_nasal_mode = get_modemax(??????_oral_nasal %>% na.omit),
      ??????_intra_tracheal_mode = get_modemax(??????_intra_tracheal %>% na.omit),
      ???????????????_?????????_mode = get_modemax(???????????????_????????? %>% na.omit),
      ????????????_????????????_mode = get_modemax(????????????_???????????? %>% na.omit),
      ????????????_??????????????????_mode = get_modemax(????????????_?????????????????? %>% na.omit))
}

write.csv(???????????????_8???_mode, file = "C:/?????????/???????????????_8???_mode.csv", row.names=FALSE)